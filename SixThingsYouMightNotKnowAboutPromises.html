<article class="article" id="post-75907">
        <header class="article_header">
          <h1 class="article_title">Six Things You Might Not Know About Promises</h1>

          
    <div class="contributor article_contributor">

          <figure class="contributor_avatar">
      <a href="http://www.sitepoint.com/author/dlau/">
        <img src="http://dab1nmslvvntp.cloudfront.net/wp-content/uploads/2014/08/1409377210dlau2-96x96.jpg" width="96" height="96" alt="Dmitri Lau" class="avatar avatar-96 wp-user-avatar wp-user-avatar-96 alignnone photo">      </a>
    </figure>
  
      <div class="contributor_details">
          <div class="contributor_name">
    <a href="http://www.sitepoint.com/author/dlau/">Dmitri Lau</a>
  </div>

        </div>

    </div>

    
          <div class="article_meta-data">
            <p class="article_pub-date">Published <time datetime="2014-01-27" pubdate="">January 27, 2014</time></p>
          </div>
          <div class="article_header__buttons">
            
            <!-- make sure to update trackTweetsAndSubscriptions in scripts.js if the Tweet button DOM path changes in the future -->
            <a class="button small transparent radius twitter-share-button" target="_blank" href="https://twitter.com/share?text=Six+Things+You+Might+Not+Know+About+Promises&amp;via=sitepointdotcom">
              <i class="icon-twitter"></i>
              Tweet
            </a>
            
            <!-- make sure to update trackTweetsAndSubscriptions in scripts.js if the Subscribe button DOM path changes in the future -->
            <a class="button small transparent radius subscribe-button" target="_blank" href="https://confirmsubscription.com/h/y/1FD5B523FA48AA2B">
              <!--<i class="icon-envelope-alt"></i>-->
              Subscribe
            </a>
            
          </div>

        </header>

        <section class="article_body">

            <p>Promises are a simple concept, and even if you haven’t had a chance to use them, you may have already read up on them. They are a valuable construct that enables asynchronous code to be structured in a more readable fasion, rather than as a mess of nested anonymous functions. This article touches on six things that you might not know about promises.</p>
<p>Before diving into the list, here is a quick reminder of what JavaScript promises look like:</p>
<div><div id="highlighter_364473" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">p = </code><code class="jscript keyword">new</code> <code class="jscript plain">Promise(</code><code class="jscript keyword">function</code><code class="jscript plain">(resolve, reject) {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">resolve(</code><code class="jscript string">"hello world"</code><code class="jscript plain">);</code></div><div class="line number3 index2 alt2"><code class="jscript plain">});</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="jscript plain">p.then(</code><code class="jscript keyword">function</code><code class="jscript plain">(str) {</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">alert(str);</code></div><div class="line number7 index6 alt2"><code class="jscript plain">});</code></div></div></td></tr></tbody></table></div></div>
<h2>1. <code>then()</code> Returns a Forked Promise</h2>
<p>What is the difference between the following two blocks of code?</p>
<div><div id="highlighter_420507" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript comments">// Exhibit A</code></div><div class="line number2 index1 alt1"><code class="jscript keyword">var</code> <code class="jscript plain">p = </code><code class="jscript keyword">new</code> <code class="jscript plain">Promise(</code><code class="jscript comments">/*...*/</code><code class="jscript plain">);</code></div><div class="line number3 index2 alt2"><code class="jscript plain">p.then(func1);</code></div><div class="line number4 index3 alt1"><code class="jscript plain">p.then(func2);</code></div></div></td></tr></tbody></table></div></div>
<div><div id="highlighter_90954" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript comments">// Exhibit B</code></div><div class="line number2 index1 alt1"><code class="jscript keyword">var</code> <code class="jscript plain">p = </code><code class="jscript keyword">new</code> <code class="jscript plain">Promise(</code><code class="jscript comments">/*...*/</code><code class="jscript plain">);</code></div><div class="line number3 index2 alt2"><code class="jscript plain">p.then(func1)</code></div><div class="line number4 index3 alt1"><code class="jscript plain">.then(func2);</code></div></div></td></tr></tbody></table></div></div>
<p>If you think both code blocks are equivalent, you may be thinking that promises are nothing more than one-dimensional arrays of callbacks. However, that is not actually the case. Every call to <code>then()</code> returns a forked promise. So, in Exhibit A, if <code>func1()</code> throws an exception, <code>func2()</code> will still be called as normal.</p>
<p>In Exhibit B, if <code>func1()</code> throws an exception, <code>func2()</code> won’t be called, because the first call to <code>then()</code> returned a new promise, which was rejected due to the exception in <code>func1()</code>. The result is that <code>func2()</code> is skipped over.</p>
<p>The takeaway: promises can fork into multiple paths like a complex flow chart.</p>
<h2>2. Callbacks Should Pass Results</h2>
<p>What gets alerted when you run the following code?</p>
<div><div id="highlighter_578249" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">p = </code><code class="jscript keyword">new</code> <code class="jscript plain">Promise(</code><code class="jscript keyword">function</code><code class="jscript plain">(resolve, reject) {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">resolve(</code><code class="jscript string">"hello world"</code><code class="jscript plain">);</code></div><div class="line number3 index2 alt2"><code class="jscript plain">});</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="jscript plain">p.then(</code><code class="jscript keyword">function</code><code class="jscript plain">(str) {})</code></div><div class="line number6 index5 alt1"><code class="jscript plain">.then(</code><code class="jscript keyword">function</code><code class="jscript plain">(str) {</code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">alert(str);</code></div><div class="line number8 index7 alt1"><code class="jscript plain">});</code></div></div></td></tr></tbody></table></div></div>
<p>The alert in the second <code>then()</code> does not display anything. This is because callbacks, in the context of promises, aren’t so much callbacks as they are transformers of results. The promise expects your callback to either return the same result or a replacement, which then gets passed on to the next callback.</p>
<p>This idea is similar to using adapters to transform a result, as shown in the following example.</p>
<div><div id="highlighter_563610" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">feetToMetres = </code><code class="jscript keyword">function</code><code class="jscript plain">(ft) { </code><code class="jscript keyword">return</code> <code class="jscript plain">ft*12*0.0254 };</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">p = </code><code class="jscript keyword">new</code> <code class="jscript plain">Promise(</code><code class="jscript comments">/*...*/</code><code class="jscript plain">);</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="jscript plain">p.then(feetToMetres)</code></div><div class="line number6 index5 alt1"><code class="jscript plain">.then(</code><code class="jscript keyword">function</code><code class="jscript plain">(metres) {</code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">alert(metres);</code></div><div class="line number8 index7 alt1"><code class="jscript plain">});</code></div></div></td></tr></tbody></table></div></div>
<h2>3. Only Exceptions From Previous Levels are Caught</h2>
<p>What is the difference between these two code blocks:</p>
<div><div id="highlighter_758294" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript comments">// Exhibit A</code></div><div class="line number2 index1 alt1"><code class="jscript keyword">new</code> <code class="jscript plain">Promise(</code><code class="jscript keyword">function</code><code class="jscript plain">(resolve, reject) {</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">resolve(</code><code class="jscript string">"hello world"</code><code class="jscript plain">);</code></div><div class="line number4 index3 alt1"><code class="jscript plain">})</code></div><div class="line number5 index4 alt2"><code class="jscript plain">.then(</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">function</code><code class="jscript plain">(str) {</code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">throw</code> <code class="jscript keyword">new</code> <code class="jscript plain">Error(</code><code class="jscript string">"uh oh"</code><code class="jscript plain">);</code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">},</code></div><div class="line number9 index8 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">undefined</code></div><div class="line number10 index9 alt1"><code class="jscript plain">)</code></div><div class="line number11 index10 alt2"><code class="jscript plain">.then(</code></div><div class="line number12 index11 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">undefined,</code></div><div class="line number13 index12 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">function</code><code class="jscript plain">(error) {</code></div><div class="line number14 index13 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">alert(error);</code></div><div class="line number15 index14 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number16 index15 alt1"><code class="jscript plain">);</code></div></div></td></tr></tbody></table></div></div>
<div><div id="highlighter_276783" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript comments">// Exhibit B</code></div><div class="line number2 index1 alt1"><code class="jscript keyword">new</code> <code class="jscript plain">Promise(</code><code class="jscript keyword">function</code><code class="jscript plain">(resolve, reject) {</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">resolve(</code><code class="jscript string">"hello world"</code><code class="jscript plain">);</code></div><div class="line number4 index3 alt1"><code class="jscript plain">})</code></div><div class="line number5 index4 alt2"><code class="jscript plain">.then(</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">function</code><code class="jscript plain">(str) {</code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">throw</code> <code class="jscript keyword">new</code> <code class="jscript plain">Error(</code><code class="jscript string">"uh oh"</code><code class="jscript plain">);</code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">},</code></div><div class="line number9 index8 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">function</code><code class="jscript plain">(error) {</code></div><div class="line number10 index9 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">alert(error);</code></div><div class="line number11 index10 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number12 index11 alt1"><code class="jscript plain">);</code></div></div></td></tr></tbody></table></div></div>
<p>In Exhibit A, when an exception is thrown in the first <code>then()</code>, it is caught in the second <code>then()</code> and “uh oh” is alerted. This follows the rule that only exceptions from previous levels are caught.</p>
<p>In Exhibit B, the callback and the error callback are at the same level, meaning when the exception is thrown in the callback, it won’t be caught. In fact, Exhibit B’s error callback will only execute if the promise is<br>
in a rejected state or if the promise itself throws an exception.</p>
<h2>4. Errors Can Be Recovered From</h2>
<p>Inside an error callback, if you don’t re-throw the error, the promise will assume that you’ve recovered from the error and will revert to the resolved state. In the following example, “I am saved” is displayed because the error callback in the first <code>then()</code> did not re-throw the exception.</p>
<div><div id="highlighter_283280" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">p = </code><code class="jscript keyword">new</code> <code class="jscript plain">Promise(</code><code class="jscript keyword">function</code><code class="jscript plain">(resolve, reject) {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">reject(</code><code class="jscript keyword">new</code> <code class="jscript plain">Error(</code><code class="jscript string">"pebkac"</code><code class="jscript plain">));</code></div><div class="line number3 index2 alt2"><code class="jscript plain">});</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="jscript plain">p.then(</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">undefined,</code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">function</code><code class="jscript plain">(error) { }</code></div><div class="line number8 index7 alt1"><code class="jscript plain">)</code></div><div class="line number9 index8 alt2"><code class="jscript plain">.then(</code></div><div class="line number10 index9 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">function</code><code class="jscript plain">(str) {</code></div><div class="line number11 index10 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">alert(</code><code class="jscript string">"I am saved!"</code><code class="jscript plain">);</code></div><div class="line number12 index11 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">},</code></div><div class="line number13 index12 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">function</code><code class="jscript plain">(error) {</code></div><div class="line number14 index13 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">alert(</code><code class="jscript string">"Bad computer!"</code><code class="jscript plain">);</code></div><div class="line number15 index14 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number16 index15 alt1"><code class="jscript plain">);</code></div></div></td></tr></tbody></table></div></div>
<p>Promises can be seen as layers on an onion. Each <code>then()</code> adds another layer to the onion. Each layer represents one activity that can be handled. After that layer is over, the result is assumed to be fixed and ready for the next layer.</p>
<h2>5. Promises Can Be Paused</h2>
<p>Just because you are already executing inside a <code>then()</code> function, doesn’t mean you can’t pause it to complete something else first. To pause the current promise, or to have it wait for the completion of another promise, simply return another promise from within <code>then()</code>.</p>
<div><div id="highlighter_349809" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">p = </code><code class="jscript keyword">new</code> <code class="jscript plain">Promise(</code><code class="jscript comments">/*...*/</code><code class="jscript plain">);</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="jscript plain">p.then(</code><code class="jscript keyword">function</code><code class="jscript plain">(str) {</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">if</code><code class="jscript plain">(!loggedIn) {</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript keyword">new</code> <code class="jscript plain">Promise(</code><code class="jscript comments">/*...*/</code><code class="jscript plain">);</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number7 index6 alt2"><code class="jscript plain">})</code></div><div class="line number8 index7 alt1"><code class="jscript plain">.then(</code><code class="jscript keyword">function</code><code class="jscript plain">(str) {</code></div><div class="line number9 index8 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">alert(</code><code class="jscript string">"Done."</code><code class="jscript plain">);</code></div><div class="line number10 index9 alt1"><code class="jscript plain">})</code></div></div></td></tr></tbody></table></div></div>
<p>In the previous code sample, the alert will not be shown until the new promise has been resolved. This is a convenient way to introduce additional dependencies inside an existing asynchonous code path. For example, you may find that the user session has timed out and you may want to initiate a secondary login before continuing on with the previous code path.</p>
<h2>6. Resolved Promises Don’t Execute Immediately</h2>
<p>What gets alerted when you run the following code?</p>
<div><div id="highlighter_754124" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">runme() {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">var</code> <code class="jscript plain">i = 0;</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">new</code> <code class="jscript plain">Promise(</code><code class="jscript keyword">function</code><code class="jscript plain">(resolve) {</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">resolve();</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">})</code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">.then(</code><code class="jscript keyword">function</code><code class="jscript plain">() {</code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">i += 2;</code></div><div class="line number9 index8 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">});</code></div><div class="line number10 index9 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">alert(i);</code></div><div class="line number11 index10 alt2"><code class="jscript plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>You may think it will alert 2, since the promise is resolved immediately and the <code>then()</code> function is executed immediately (synchronously). However, the promise specification requires all calls to be forcefully asynchronous in an effort to be uniform. Therefore, the alert is called before the value of <code>i</code> is modified.</p>
<p>Links:<br>
Download various implementations of the <a href="https://github.com/promises-aplus/promises-spec/blob/master/implementations.md">Promise/A+ API</a>.</p>

        </section>

        <div class="article__author-bios">
          
    <div class="contributor contributor--large">

          <figure class="contributor_avatar">
      <a href="http://www.sitepoint.com/author/dlau/">
        <img src="http://dab1nmslvvntp.cloudfront.net/wp-content/uploads/2014/08/1409377210dlau2-96x96.jpg" width="96" height="96" alt="Dmitri Lau" class="avatar avatar-96 wp-user-avatar wp-user-avatar-96 alignnone photo">      </a>
    </figure>
  
      <div class="contributor_details">

          <div class="contributor_name">
    <a href="http://www.sitepoint.com/author/dlau/">Dmitri Lau</a>
  </div>

  
        <p class="contributor_longdesc">Dmitri Lau is a freelance Ajax developer with a penchant for statistical analysis. When not improving a meta template engine's relative response yield, yawning uninterruptedly every night has become a norm which he hopes will soon be over when his Hong Kong based startup picks up.</p>

        <ul class="contributor_social">
          <li><a href="http://www.linkedin.com/in/dmitrilau" target="_blank"><i class="icon-linkedin"></i></a></li><li><a href="https://plus.google.com/+DmitriLau/" target="_blank"><i class="icon-google-plus"></i></a></li><li><a href="http://www.th3.ca/resellers/" target="_blank"><i class="icon-youtube"></i></a></li>        </ul>
      </div>
    </div>

          </div>

                  <div class="related-content">
            <h2>You might also like:</h2>
            <ul class="article-list article-list--related">
              <li class="article-list_item  tile post-tile">
  <article class="article article--micro article--micro--related category-web " data-disqus-id="http://www.sitepoint.com/radar-week-origin-javascript-shapely-css/">
    <header class="article_category"><h2 class="article_category_title"><a href="http://www.sitepoint.com/web/">Web</a><a class="comment-info"></a></h2></header>
    
    <section class="article_header">
      <h1 class="article_title"><a href="http://www.sitepoint.com/radar-week-origin-javascript-shapely-css/">On Our Radar This Week: the Origin of JavaScript and Shapely CSS</a></h1>
      <div class="contributor article_contributor">
        <p class="contributor_name article_author-name">by <a href="http://www.sitepoint.com/author/jhibbard/">James Hibbard</a></p>
      </div>
      
      <div class="article_meta-data"><p class="article_pub-date"><time datetime="2014-09-05 10:00:07" pubdate="">Sep 05, 2014</time></p></div>
      </section>
  </article>
</li>              <div class="widget maestro maestro-content-type-html " id="maestro-product-16"><li class="article-list_item  tile post-tile">
  <article class="article article--micro article--micro--related category-web">
    <header class="article_category"><h2 class="article_category_title"><a href="https://learnable.com?utm_source=sitepoint&amp;utm_medium=related-items&amp;utm_content=js-javascript">Learnable</a></h2></header>
    <section class="article_header">
      <h1 class="article_title"><a href="https://learnable.com/books/jump-start-javascript?utm_source=sitepoint&amp;utm_medium=related-items&amp;utm_content=js-javascript">Book: Jump Start JavaScript</a></h1>
      <div class="contributor article_contributor">
        <p class="contributor_name article_author-name">by <a href="http://www.sitepoint.com/author/ara-pehlivanian/">Ara Pehlivanian</a> and <a href="https://learnable.com/users/donnyguyen?utm_source=sitepoint&amp;utm_medium=related-items&amp;utm_content=js-javascript">Don Nguyen</a></p>
      </div>
      <div class="article_meta-data"><p class="article_pub-date">PREMIUM</p></div>
    </section>
  </article>
</li></div>              <li class="article-list_item  tile post-tile">
  <article class="article article--micro article--micro--related category-web " data-disqus-id="http://www.sitepoint.com/on-our-radar-this-week-programming-languages-iot-and-screencasts/">
    <header class="article_category"><h2 class="article_category_title"><a href="http://www.sitepoint.com/web/">Web</a><a class="comment-info" href="http://www.sitepoint.com/on-our-radar-this-week-programming-languages-iot-and-screencasts/#comments"><span class="comment-info__count">2</span><span class="comment-info__icon icon-comment"></span></a></h2></header>
    
    <section class="article_header">
      <h1 class="article_title"><a href="http://www.sitepoint.com/on-our-radar-this-week-programming-languages-iot-and-screencasts/">On Our Radar This Week: Programming Languages, IOT and Screencasts</a></h1>
      <div class="contributor article_contributor">
        <p class="contributor_name article_author-name">by <a href="http://www.sitepoint.com/author/jhibbard/">James Hibbard</a></p>
      </div>
      
      <div class="article_meta-data"><p class="article_pub-date"><time datetime="2014-07-18 10:00:13" pubdate="">Jul 18, 2014</time></p></div>
      </section>
  </article>
</li>          </ul>
        </div>
        
        <div class="promo-panel">
          <div class="widget maestro maestro-content-type-product " id="maestro-product-29"><div class="promo-panel_media-object"><img src="https://d2sis3lil8ndrq.cloudfront.net/books/jshtml-basics1_medium_3d.png"></div>
<div class="promo-panel_content">
  <h1 class="promo-panel_title">
    Free book: Jump Start HTML5 Basics
  </h1>
  <p>Grab a free copy of one our latest ebooks! Packed with hints and tips on HTML5's most powerful new features.</p>
  <form class="promo-panel_action"><input type="email" name="email" class="promo-panel_email" placeholder="email address"><input type="hidden" name="content" value="29"><button class="button radius">Claim Book<div class="spinner" role="progressbar" style="position: relative; width: 0px; z-index: 2000000000;"><div style="position: absolute; top: -1px; opacity: 0.25; -webkit-animation: opacity-72-25-0-13 1.4285714285714286s linear infinite;"><div style="position: absolute; width: 5px; height: 2px; background-color: rgb(0, 0, 0); box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 1px; -webkit-transform-origin: 0% 50%; -webkit-transform: rotate(0deg) translate(7px, 0px); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px; background-position: initial initial; background-repeat: initial initial;"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; -webkit-animation: opacity-72-25-1-13 1.4285714285714286s linear infinite;"><div style="position: absolute; width: 5px; height: 2px; background-color: rgb(0, 0, 0); box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 1px; -webkit-transform-origin: 0% 50%; -webkit-transform: rotate(27deg) translate(7px, 0px); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px; background-position: initial initial; background-repeat: initial initial;"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; -webkit-animation: opacity-72-25-2-13 1.4285714285714286s linear infinite;"><div style="position: absolute; width: 5px; height: 2px; background-color: rgb(0, 0, 0); box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 1px; -webkit-transform-origin: 0% 50%; -webkit-transform: rotate(55deg) translate(7px, 0px); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px; background-position: initial initial; background-repeat: initial initial;"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; -webkit-animation: opacity-72-25-3-13 1.4285714285714286s linear infinite;"><div style="position: absolute; width: 5px; height: 2px; background-color: rgb(0, 0, 0); box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 1px; -webkit-transform-origin: 0% 50%; -webkit-transform: rotate(83deg) translate(7px, 0px); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px; background-position: initial initial; background-repeat: initial initial;"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; -webkit-animation: opacity-72-25-4-13 1.4285714285714286s linear infinite;"><div style="position: absolute; width: 5px; height: 2px; background-color: rgb(0, 0, 0); box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 1px; -webkit-transform-origin: 0% 50%; -webkit-transform: rotate(110deg) translate(7px, 0px); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px; background-position: initial initial; background-repeat: initial initial;"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; -webkit-animation: opacity-72-25-5-13 1.4285714285714286s linear infinite;"><div style="position: absolute; width: 5px; height: 2px; background-color: rgb(0, 0, 0); box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 1px; -webkit-transform-origin: 0% 50%; -webkit-transform: rotate(138deg) translate(7px, 0px); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px; background-position: initial initial; background-repeat: initial initial;"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; -webkit-animation: opacity-72-25-6-13 1.4285714285714286s linear infinite;"><div style="position: absolute; width: 5px; height: 2px; background-color: rgb(0, 0, 0); box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 1px; -webkit-transform-origin: 0% 50%; -webkit-transform: rotate(166deg) translate(7px, 0px); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px; background-position: initial initial; background-repeat: initial initial;"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; -webkit-animation: opacity-72-25-7-13 1.4285714285714286s linear infinite;"><div style="position: absolute; width: 5px; height: 2px; background-color: rgb(0, 0, 0); box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 1px; -webkit-transform-origin: 0% 50%; -webkit-transform: rotate(193deg) translate(7px, 0px); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px; background-position: initial initial; background-repeat: initial initial;"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; -webkit-animation: opacity-72-25-8-13 1.4285714285714286s linear infinite;"><div style="position: absolute; width: 5px; height: 2px; background-color: rgb(0, 0, 0); box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 1px; -webkit-transform-origin: 0% 50%; -webkit-transform: rotate(221deg) translate(7px, 0px); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px; background-position: initial initial; background-repeat: initial initial;"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; -webkit-animation: opacity-72-25-9-13 1.4285714285714286s linear infinite;"><div style="position: absolute; width: 5px; height: 2px; background-color: rgb(0, 0, 0); box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 1px; -webkit-transform-origin: 0% 50%; -webkit-transform: rotate(249deg) translate(7px, 0px); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px; background-position: initial initial; background-repeat: initial initial;"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; -webkit-animation: opacity-72-25-10-13 1.4285714285714286s linear infinite;"><div style="position: absolute; width: 5px; height: 2px; background-color: rgb(0, 0, 0); box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 1px; -webkit-transform-origin: 0% 50%; -webkit-transform: rotate(276deg) translate(7px, 0px); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px; background-position: initial initial; background-repeat: initial initial;"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; -webkit-animation: opacity-72-25-11-13 1.4285714285714286s linear infinite;"><div style="position: absolute; width: 5px; height: 2px; background-color: rgb(0, 0, 0); box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 1px; -webkit-transform-origin: 0% 50%; -webkit-transform: rotate(304deg) translate(7px, 0px); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px; background-position: initial initial; background-repeat: initial initial;"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; -webkit-animation: opacity-72-25-12-13 1.4285714285714286s linear infinite;"><div style="position: absolute; width: 5px; height: 2px; background-color: rgb(0, 0, 0); box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 1px; -webkit-transform-origin: 0% 50%; -webkit-transform: rotate(332deg) translate(7px, 0px); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px; background-position: initial initial; background-repeat: initial initial;"></div></div></div></button></form>
</div></div>        </div>

                
        <a id="comments"></a>
        
<div id="disqus_thread"><iframe id="dsq-2" data-disqus-uid="2" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="http://disqus.com/embed/comments/?base=default&amp;disqus_version=17daf177&amp;f=sitepointproduction&amp;t_i=75907%20http%3A%2F%2Fwww.sitepoint.com%2F%3Fp%3D75907&amp;t_u=http%3A%2F%2Fwww.sitepoint.com%2Fsix-things-might-know-promises%2F&amp;t_e=Six%20Things%20You%20Might%20Not%20Know%20About%20Promises&amp;t_d=Six%20Things%20You%20Might%20Not%20Know%20About%20Promises&amp;t_t=Six%20Things%20You%20Might%20Not%20Know%20About%20Promises&amp;s_o=default&amp;l=#2" style="width: 100% !important; border: none !important; overflow: hidden !important; height: 626px !important;" horizontalscrolling="no" verticalscrolling="no"></iframe></div>

<script type="text/javascript">
/* <![CDATA[ */
    var disqus_url = 'http://www.sitepoint.com/six-things-might-know-promises/';
    var disqus_identifier = '75907 http://www.sitepoint.com/?p=75907';
    var disqus_container_id = 'disqus_thread';
    var disqus_domain = 'disqus.com';
    var disqus_shortname = 'sitepointproduction';
    var disqus_title = "Six Things You Might Not Know About Promises";
        var disqus_config = function () {
        var config = this; // Access to the config object
        config.language = '';

        /*
           All currently supported events:
            * preData — fires just before we request for initial data
            * preInit - fires after we get initial data but before we load any dependencies
            * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
            * afterRender - fires when template is rendered but before we show it
            * onReady - everything is done
         */

        config.callbacks.preData.push(function() {
            // clear out the container (its filled for SEO/legacy purposes)
            document.getElementById(disqus_container_id).innerHTML = '';
        });
                config.callbacks.onReady.push(function() {
            // sync comments in the background so we don't block the page
            var script = document.createElement('script');
            script.async = true;
            script.src = '?cf_action=sync_comments&post_id=75907';

            var firstScript = document.getElementsByTagName( "script" )[0];
            firstScript.parentNode.insertBefore(script, firstScript);
        });
                    };
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
    var DsqLocal = {
        'trackbacks': [
        ],
        'trackback_url': "http:\/\/www.sitepoint.com\/six-things-might-know-promises\/trackback\/"    };
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.' + 'disqus.com' + '/embed.js?pname=wordpress&pver=2.74';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

</article>
